{"version":3,"sources":["mirror.js"],"names":["clockComponent","$","mainMessageComponent","hideAll","fadeOut","showAll","fadeIn","degreeChar","String","fromCharCode","createForecastHour","forecast","el","hour","icon","temp","onForecastReady","table","empty","hourly","forEach","h","td","append","onConditionsReady","conditions","targetEl","conditionsEl","location","weather","onSunsetReady","sunset","sunsetEl","iconUrl","message","getCoords","coords","subscribe","setGreeting","text","getCompliment","loopCompliments","comp","init","now","time","newsTargetEl","showingArticles","renderQrCode","article","qrcode","url","background","foreground","height","width","renderNewsArticle","articleEl","urlToImage","title","description","getNewsSourceEl","source","name","renderNewsSourcesPage","sources","s","getNewsSources","unsubscribe","getSources","getNext","getNextPageSources","returnToNews","getNewsFrom","changeSource","commandsEl","showCommands","getTriggers","com","setTimeout","whenSaid","getPreviousArticle","start"],"mappings":"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","file":"mirror.js","sourcesContent":["import '../node_modules/jquery.qrcode/jquery.qrcode.min';\nimport { Location } from 'location';\nimport { weatherService } from 'weather';\nimport { greetingService } from 'greeting';\nimport { voiceService } from 'voiceService';\nimport { clock } from 'clock';\nimport { newsService } from 'newsService';\n\nconst clockComponent = $('#clock');\nconst mainMessageComponent = $('#greeting');\n\n/********* GLOBAL *********/\nconst hideAll = () => {\n    $('#mirror').fadeOut(500);\n}\n\nconst showAll = () => {\n    $('#mirror').fadeIn(500);\n}\n\n/********* WEATHER *********/\nconst degreeChar = String.fromCharCode(176);\n\nconst createForecastHour = (forecast) => {\n    let el = `<div class=\"forecast hour\">${forecast.hour}</div>` +\n        `<img class=\"forecast icon\" src=\"${forecast.icon}\" />` +\n        `<div class=\"forecast temp\">` +\n        `<span>${forecast.temp}</span>` +\n        `<span class=\"degree\">${degreeChar}</span>` +\n        `</div>`;\n    return el;\n}\n\nconst onForecastReady = (forecast) => {\n    let table = $('.hourly-forecast');\n    table.empty();\n    forecast.hourly.forEach((h) => {\n        let td = $(`<td>${createForecastHour(h)}</td>`)\n        table.append(td);\n    })\n};\n\nconst onConditionsReady = (conditions) => {\n    let targetEl = $('.current-temp');\n    let conditionsEl = $(`<h5>${conditions.location}</h5>` +\n        `<h1>${conditions.temp}${degreeChar}</h1>` +\n        `<p>${conditions.weather}</p>` +\n        `<img src=\"${conditions.icon}\"/>`);\n    targetEl.empty();\n    targetEl.append(conditionsEl);\n}\n\nconst onSunsetReady = (sunset) => {\n    let targetEl = $('#sunset');\n    let sunsetEl = $(`<div><img src=\"${sunset.iconUrl}\" id=\"sunset-icon\"><span class=\"sunset-message\">${sunset.message}</span></div>`);\n    targetEl.empty();\n    targetEl.append(sunsetEl);\n}\n\nconst location = new Location();\nlocation.getCoords((coords) => {\n    weatherService.subscribe('forecast', 900000, coords, onForecastReady);\n    weatherService.subscribe('conditions', 1800000, coords, onConditionsReady);\n    weatherService.subscribe('sunset', 1800000, coords, onSunsetReady);\n});\n\n/********* GREETING *********/\nconst setGreeting = () => {\n    mainMessageComponent.text(greetingService.getCompliment());\n};\nsetGreeting();\n\ngreetingService.loopCompliments(600, (comp) => {\n    mainMessageComponent.text(comp);\n});\n\n/********* CLOCK *********/\nclock.init((now) => {\n    clockComponent.text(now.time);\n});\n\n/********* NEWS FEED *********/\nconst newsTargetEl = $('#news-feed');\nlet showingArticles = true;\n\nconst renderQrCode = (article) => {\n    $('#qrcode').empty();\n    $('#qrcode').qrcode({\n        text: article.url,\n        background: '#FFFFFF',\n        foreground: '#000000',\n        height: 100,\n        width: 100\n    });\n}\n\nconst renderNewsArticle = (article) => {\n    if (!showingArticles) return;\n\n    newsTargetEl.empty();\n    let articleEl = $(`<div class=\"row\">` +\n        `<img class=\"thumbnail three columns\" src=\"${article.urlToImage}\" onerror=\"this.src='images/day/unknown.png'\"/>` +\n        `<div class=\"seven columns\">` +\n        `<h5>${article.title}</h3>` +\n        `<p>${article.description}</p>` +\n        `</div>` +\n        `<div id=\"qrcode\" class=\"two columns\"></div>` +\n        `</div>`);\n    newsTargetEl.append(articleEl);\n    renderQrCode(article);\n}\n\nconst getNewsSourceEl = (source) => {\n    return $(`<div class=\"three columns news-source\">` +\n        `${source.name}` +\n        `</div>`);\n}\n\nconst renderNewsSourcesPage = (sources) => {\n    newsTargetEl.empty();\n    sources.forEach((s) => {\n        newsTargetEl.append(getNewsSourceEl(s));\n    });\n}\n\nconst getNewsSources = () => {\n    showingArticles = false;\n    newsService.unsubscribe();\n    newsService.getSources(renderNewsSourcesPage);\n}\n\nconst getNext = () => {\n    let sources = newsService.getNextPageSources();\n    renderNewsSourcesPage(sources);\n}\n\nconst returnToNews = () => {\n    if (showingArticles) return;\n    showingArticles = true;\n    newsService.unsubscribe();\n    newsService.subscribe(45, 45, renderNewsArticle);\n}\n\nconst getNewsFrom = (source) => {\n    showingArticles = true;\n    newsService.unsubscribe();\n    newsService.changeSource(source, () => {\n        newsService.subscribe(120, 45, renderNewsArticle);\n    });\n}\n\nnewsService.subscribe(45, 45, renderNewsArticle);\n\n/********* VOICE *********/\nconst commandsEl = $('<ul></ul>');\n\nconst showCommands = () => {\n    mainMessageComponent.empty();\n    commandsEl.empty();\n    voiceService.getTriggers().forEach((com) => {\n        if (com === 'Show me commands') return;\n        commandsEl.append(`<li class=\"command\">${com}</li>`);\n    });\n    mainMessageComponent.append(commandsEl);\n    setTimeout(setGreeting, 20000)\n}\n\nvoiceService\n    .whenSaid('Show me commands', showCommands)\n    .whenSaid('Hello Yoda', setGreeting)\n    .whenSaid('Show me news sources', getNewsSources)\n    .whenSaid('Show me next', getNext)\n    .whenSaid('Show me the news', returnToNews)\n    .whenSaid('Show me news from *source', getNewsFrom)\n    .whenSaid('Go back', newsService.getPreviousArticle)\n    .whenSaid('Hide all', hideAll)\n    .whenSaid('Show all', showAll)\n    .start();"]}